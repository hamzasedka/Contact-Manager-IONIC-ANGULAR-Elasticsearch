<div class="container" [formGroup]="this.tableForm">
  <mat-table [formArrayName]="this.priceCardsArrayName" [dataSource]="this.formArray.value"
    [trackBy]="this.trackByPriceCard">

    <!-- name -->
    <ng-container matColumnDef="name">
      <mat-header-cell fxFlex *matHeaderCellDef>Nom</mat-header-cell>
      <mat-cell fxFlex *matCellDef="let element; let rowIndex = index" [formGroupName]="rowIndex">
        <mat-form-field class="currency" fxFlex="calc(100% - 1em)" color="accent" appearance="outline">
          <mat-label>Nom</mat-label>
          <input type="text" matInput placeholder="Nom" required formControlName="name" />
        </mat-form-field>
      </mat-cell>
    </ng-container>

    <!-- priceExcludeTaxe -->
    <ng-container matColumnDef="priceExcludeTaxe">
      <mat-header-cell fxFlex *matHeaderCellDef>Prix HT</mat-header-cell>
      <mat-cell fxFlex *matCellDef="let element; let rowIndex = index" [formGroupName]="rowIndex">
        <mat-form-field class="currency" fxFlex="calc(100% - 1em)" color="accent" appearance="outline">
          <mat-label>Prix HT</mat-label>
          <span matPrefix>{{ this.getCurrency(rowIndex) }}&nbsp;</span>
          <input type="number" matInput placeholder="Prix HT" required min="0" formControlName="priceExcludeTaxe" />
        </mat-form-field>
      </mat-cell>
    </ng-container>

    <!-- priceIncludeTaxe -->
    <ng-container matColumnDef="priceIncludeTaxe">
      <mat-header-cell fxFlex *matHeaderCellDef>Prix TTC</mat-header-cell>
      <mat-cell fxFlex *matCellDef="let element; let rowIndex = index" [formGroupName]="rowIndex">
        <mat-form-field class="currency" fxFlex="calc(100% - 1em)" color="accent" appearance="outline">
          <mat-label>Prix TTC</mat-label>
          <span matPrefix>{{ this.getCurrency(rowIndex) }}&nbsp;</span>
          <input type="number" matInput placeholder="Prix TTC" required min="0" formControlName="priceIncludeTaxe" />
        </mat-form-field>
      </mat-cell>
    </ng-container>

    <!-- strikethroughPrice -->
    <ng-container matColumnDef="strikethroughPrice">
      <mat-header-cell fxFlex *matHeaderCellDef>Ancien Prix</mat-header-cell>
      <mat-cell fxFlex *matCellDef="let element; let rowIndex = index" [formGroupName]="rowIndex">
        <mat-form-field class="currency" fxFlex="calc(100% - 1em)" color="accent" appearance="outline">
          <mat-label>Ancien Prix</mat-label>
          <span matPrefix>{{ this.getCurrency(rowIndex) }}&nbsp;</span>
          <input type="number" matInput placeholder="Ancien Prix" required min="0"
            formControlName="strikethroughPrice" />
        </mat-form-field>
      </mat-cell>
    </ng-container>

    <!-- canApplyPromotion -->
    <ng-container matColumnDef="canApplyPromotion">
      <mat-header-cell fxFlex *matHeaderCellDef>Peux appliquer un code promotion</mat-header-cell>
      <mat-cell fxFlex *matCellDef="let element; let rowIndex = index" [formGroupName]="rowIndex">
        <mat-checkbox formControlName="canApplyPromotion" placeholder="Peux appliquer un code promotion">Peux appliquer
          un code promotion</mat-checkbox>
      </mat-cell>
    </ng-container>

    <!-- contractCommitment -->
    <ng-container matColumnDef="contractCommitment">
      <mat-header-cell fxFlex *matHeaderCellDef>Durée d'engagement</mat-header-cell>
      <mat-cell fxFlex *matCellDef="let element; let rowIndex = index" [formGroupName]="rowIndex">
        <mat-form-field class="currency" fxFlex="calc(100% - 1em)" color="accent" appearance="outline">
          <mat-label>Durée d'engagement</mat-label>
          <input type="number" matInput placeholder="Durée d'engagement" required min="0"
            formControlName="contractCommitment" />
        </mat-form-field>
      </mat-cell>
    </ng-container>

    <!-- contractCommitmentUnit -->
    <ng-container matColumnDef="contractCommitmentUnit">
      <mat-header-cell fxFlex *matHeaderCellDef>Unité de la durée d'engagement</mat-header-cell>
      <mat-cell fxFlex *matCellDef="let element; let rowIndex = index" [formGroupName]="rowIndex">
        <mat-form-field class="currency" fxFlex="calc(100% - 1em)" color="accent" appearance="outline">
          <mat-label>Unité de la durée d'engagement</mat-label>
          <mat-select formControlName="contractCommitmentUnit" placeholder="Unité de la durée d'engagement" required>
            <mat-option *ngFor="let unit of this.contractCommitmentUnits;" [value]="unit.id">
              {{ unit.name }}
            </mat-option>
          </mat-select>
        </mat-form-field>
      </mat-cell>
    </ng-container>

    <!-- delete -->
    <ng-container matColumnDef="delete">
      <mat-header-cell fxFlex *matHeaderCellDef>#</mat-header-cell>
      <mat-cell fxFlex *matCellDef="let element; let rowIndex = index">
        <button mat-mini-fab color="accent" (click)="this.onDelete(rowIndex, $event)">
          <mat-icon>delete</mat-icon>
        </button>
      </mat-cell>
    </ng-container>

    <mat-header-row *matHeaderRowDef="this.displayedColumns"></mat-header-row>
    <mat-row *matRowDef="let row; columns: this.displayedColumns;"></mat-row>
  </mat-table>
</div>
